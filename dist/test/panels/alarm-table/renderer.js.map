{"version":3,"sources":["../../../../src/panels/alarm-table/renderer.js"],"names":["TableRenderer","panel","table","isUtc","sanitize","selectionMgr","initColumns","formatters","colorState","colIndex","columns","length","column","title","text","i","styles","style","regex","stringToJsRegex","pattern","match","alias","replace","createColumnFormatter","v","undefined","isArray","join","escape","defaultCellFormatter","type","date","utc","format","dateFormat","valueFormatter","valueFormats","unit","isString","colorMode","getColorForValue","decimals","value","columnIndex","addWidthHack","formatColumnValue","classes","cell","widthHack","hidden","width","clip","stylesAsString","reduce","map","val","key","memo","row","isRowSelected","source","meta","alarmId","alarm","id","page","pageSize","startPos","endPos","Math","min","rows","html","y","nextRow","cellHtml","rowStyle","rowClasses","severity","label","toLowerCase","severityIcons","icon","getIconForSeverity","renderCell","push","rowClass","new_row","thresholds","colors","first"],"mappings":"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","file":"renderer.js","sourcesContent":["import _ from 'lodash';\nimport moment from 'moment';\nimport kbn from 'app/core/utils/kbn';\n\nexport class TableRenderer {\n\n  constructor(panel, table, isUtc, sanitize, selectionMgr) {\n    this.panel = panel;\n    this.table = table;\n    this.isUtc = isUtc;\n    this.sanitize = sanitize;\n    this.selectionMgr = selectionMgr;\n\n    this.initColumns();\n  }\n\n  setTable(table) {\n    this.table = table;\n\n    this.initColumns();\n  }\n\n  initColumns() {\n    this.formatters = [];\n    this.colorState = {};\n\n    for (let colIndex = 0; colIndex < this.table.columns.length; colIndex++) {\n      let column = this.table.columns[colIndex];\n      column.title = column.text;\n\n      for (let i = 0; i < this.panel.styles.length; i++) {\n        let style = this.panel.styles[i];\n\n        let regex = kbn.stringToJsRegex(style.pattern);\n        if (column.text.match(regex)) {\n          column.style = style;\n\n          if (style.alias) {\n            column.title = column.text.replace(regex, style.alias);\n          }\n\n          break;\n        }\n      }\n\n      this.formatters[colIndex] = this.createColumnFormatter(column);\n    }\n  }\n\n  static getColorForValue(value, style) {\n    if (!style.thresholds) {\n      return null;\n    }\n\n    for (let i = style.thresholds.length; i > 0; i--) {\n      if (value >= style.thresholds[i - 1]) {\n        return style.colors[i];\n      }\n    }\n    return _.first(style.colors);\n  }\n\n  defaultCellFormatter(v, style) {\n    if (v === null || v === void 0 || v === undefined) {\n      return '';\n    }\n\n    if (_.isArray(v)) {\n      v = v.join(', ');\n    }\n\n    if (style && style.sanitize) {\n      return this.sanitize(v);\n    } else {\n      return _.escape(v);\n    }\n  }\n\n  createColumnFormatter(column) {\n    if (!column.style) {\n      return this.defaultCellFormatter;\n    }\n\n    if (column.style.type === 'hidden') {\n      return v => {\n        return undefined;\n      };\n    }\n\n    if (column.style.type === 'date') {\n      return v => {\n        if (v === undefined || v === null) {\n          return '-';\n        }\n\n        if (_.isArray(v)) {\n          v = v[0];\n        }\n        let date = moment(v);\n        if (this.isUtc) {\n          date = date.utc();\n        }\n        return date.format(column.style.dateFormat);\n      };\n    }\n\n    if (column.style.type === 'number') {\n      let valueFormatter = kbn.valueFormats[column.unit || column.style.unit];\n\n      return v => {\n        if (v === null || v === void 0) {\n          return '-';\n        }\n\n        if (_.isString(v)) {\n          return this.defaultCellFormatter(v, column.style);\n        }\n\n        if (column.style.colorMode) {\n          this.colorState[column.style.colorMode] = TableRenderer.getColorForValue(v, column.style);\n        }\n\n        return valueFormatter(v, column.style.decimals, null);\n      };\n    }\n\n    return (value) => {\n      return this.defaultCellFormatter(value, column.style);\n    };\n  }\n\n  formatColumnValue(colIndex, value) {\n    return this.formatters[colIndex] ? this.formatters[colIndex](value) : value;\n  }\n\n  renderCell(columnIndex, value, addWidthHack = false) {\n    value = this.formatColumnValue(columnIndex, value);\n    let column = this.table.columns[columnIndex];\n    let styles = {};\n    let classes = [];\n\n    if (this.colorState.cell) {\n      styles['background-color'] = this.colorState.cell;\n      styles['color'] = 'white';\n      this.colorState.cell = null;\n    } else if (this.colorState.value) {\n      styles['color'] = this.colorState.value;\n      this.colorState.value = null;\n    }\n\n    // because of the fixed table headers css only solution\n    // there is an issue if header cell is wider the cell\n    // this hack adds header content to cell (not visible)\n    let widthHack = '';\n    if (addWidthHack) {\n      widthHack = '<div class=\"table-panel-width-hack\">' + column.title + '</div>';\n    }\n\n    if (value === undefined) {\n      styles['display'] = 'none';\n      column.hidden = true;\n    } else {\n      column.hidden = false;\n    }\n\n    if (column.style.width) {\n      styles['width'] = column.style.width;\n      if (column.style.clip) {\n        styles['max-width'] = column.style.width;\n        styles['white-space'] = 'nowrap';\n      }\n    }\n\n    if (column.style.clip) {\n      styles['overflow'] = 'hidden';\n      styles['text-overflow'] = 'ellipsis';\n    }\n\n    let stylesAsString = 'style=\"' + _.reduce(_.map(styles, function(val, key){ return key + ':' + val; }),\n      (memo, style) => {\n        if (memo.length > 0) {\n          return memo + '; ' + style;\n        } else {\n          return style;\n        }\n      }, '') + '\"';\n\n    return '<td ' + stylesAsString + '>' + value + widthHack + '</td>';\n  }\n\n  static getIconForSeverity(severity) {\n    let icon = 'ion-help';\n    switch(severity) {\n      case 'indeterminate':\n        icon = 'ion-help';\n        break;\n      case 'warning':\n        icon = 'ion-alert-circled';\n        break;\n      case 'minor':\n        icon = 'ion-flash';\n        break;\n      case 'major':\n        icon = 'ion-flame';\n        break;\n      case 'critical':\n        icon = 'ion-nuclear';\n        break;\n      case 'normal':\n        icon = 'ion-leaf';\n        break;\n      case 'cleared':\n        icon = 'ion-checkmark-circled';\n        break;\n    }\n    return icon;\n  }\n\n  isRowSelected(row) {\n    return this.selectionMgr.isRowSelected({\n      source: row.meta.source,\n      alarmId: row.meta.alarm.id\n    });\n  }\n\n  render(page) {\n    let pageSize = this.panel.pageSize || 100;\n    let startPos = page * pageSize;\n    let endPos = Math.min(startPos + pageSize, this.table.rows.length);\n    let html = \"\";\n\n    for (let y = startPos; y < endPos; y++) {\n      let row = this.table.rows[y];\n      let nextRow;\n      if (y+1 < endPos) {\n        nextRow = this.table.rows[y+1];\n      }\n\n      let cellHtml = '';\n      let rowStyle = '';\n      let rowClasses = [];\n\n      let source = row.meta.source.replace(/'/g, '\\\\\\'');\n      let alarm = row.meta.alarm;\n      let severity = alarm.severity.label.toLowerCase();\n\n      if (this.panel.severityIcons) {\n        let icon = TableRenderer.getIconForSeverity(severity);\n        cellHtml += `<td class=\"severity-icon text-center\"><i class=\"icon ${icon}\"></i></td>`;\n      }\n\n      for (let i = 0; i < this.table.columns.length; i++) {\n        cellHtml += this.renderCell(i, row[i], y === startPos);\n      }\n\n      if (this.colorState.row) {\n        rowStyle = ' style=\"background-color:' + this.colorState.row + ';color: white\"';\n        this.colorState.row = null;\n      }\n\n      if (this.panel.severity) {\n        rowClasses.push(severity);\n      }\n\n      if (this.isRowSelected(row)) {\n        rowClasses.push(\"selected\");\n      }\n\n      if (nextRow && this.isRowSelected(nextRow)) {\n        rowClasses.push(\"next-selected\");\n      }\n\n      let rowClass = 'class=\"' + rowClasses.join(' ') + '\"';\n      html += '<tr ' + rowStyle + rowClass + ` ng-click=\"ctrl.onRowClick($event, '${source}', ${alarm.id})\"  ng-dblclick=\"ctrl.onRowDoubleClick($event, '${source}', ${alarm.id})\" context-menu=\"ctrl.getContextMenu($event, '${source}', ${alarm.id})\">` + cellHtml + '</tr>';\n    }\n\n    return html;\n  }\n\n  render_values() {\n    let rows = [];\n\n    for (let y = 0; y < this.table.rows.length; y++) {\n      let row = this.table.rows[y];\n      let new_row = [];\n      for (let i = 0; i < this.table.columns.length; i++) {\n        new_row.push(this.formatColumnValue(i, row[i]));\n      }\n      rows.push(new_row);\n    }\n    return {\n      columns: this.table.columns,\n      rows: rows,\n    };\n  }\n}\n"]}