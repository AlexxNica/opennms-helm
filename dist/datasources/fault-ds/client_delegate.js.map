{"version":3,"sources":["../../../src/datasources/fault-ds/client_delegate.js"],"names":["API","Client","Rest","DAO","Model","_","ClientDelegate","settings","backendSrv","$q","type","url","name","searchLimit","server","OnmsServer","http","GrafanaHTTP","client","clientWithMetadata","undefined","self","getMetadata","then","metadata","getClientWithMetadata","alarms","filter","getAlarmDao","alarmDao","theFilter","FilterInitializer","createFilter","find","alarmId","options","datasourceRequest","method","headers","params","data","action","supportedActions","indexOf","message","limit","match","comparator","orderBy","order","label","query","sysName","results","count","totalCount","node","user","location","category","severities","map","Severities","severity","id","when","element","operators","Operators","operator","attributes","attributeName","getAttributes","attribute","comparatorMapping","comparators","console","log","newFilter","Filter","clauses","createNestedRestriction","clause","restriction","nestedRestriction","Clause","createRestriction","newNestedRestriction","NestedRestriction","each","withClause","createClause","Comparators","Restriction","value"],"mappings":"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","file":"client_delegate.js","sourcesContent":["import {API, Client, Rest, DAO, Model} from '../../opennms'\nimport _ from 'lodash';\n\nexport class ClientDelegate {\n\n    constructor(settings, backendSrv, $q) {\n        this.type = settings.type;\n        this.url = settings.url;\n        this.name = settings.name;\n        this.backendSrv = backendSrv;\n        this.searchLimit = 1000;\n        this.$q = $q;\n\n        let server = new API.OnmsServer(this.name, this.url);\n        let http = new Rest.GrafanaHTTP(this.backendSrv, server);\n        this.client = new Client(http);\n        this.client.server = server;\n        this.clientWithMetadata = undefined;\n     }\n\n    getClientWithMetadata() {\n        if (!this.clientWithMetadata) {\n              let self = this;\n              this.clientWithMetadata = Client.getMetadata(this.client.server, this.client.http)\n                .then(function(metadata) {\n                    self.client.server.metadata = metadata;\n                    return self.client;\n                });\n        }\n        return this.clientWithMetadata;\n      }\n\n    getAlarmDao() {\n        return this.getClientWithMetadata().then(function(client) {\n            return client.alarms();\n        });\n    }\n\n    findAlarms(filter) {\n        return this.getAlarmDao()\n            .then(function(alarmDao) {\n                var theFilter = new FilterInitializer().createFilter(filter);\n                return alarmDao.find(theFilter);\n            });\n    }\n\n    doUpdate(alarmId, options) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/api/v2/alarms/' + alarmId,\n            method: 'PUT',\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n            },\n            params: options || {},\n            data: '' // empty data or Content-Type header is reset\n        });\n    }\n\n    doTicketAction(alarmId, action) {\n        var supportedActions = [\"create\", \"update\", \"close\"];\n        if (supportedActions.indexOf(action) < 0) {\n            throw {message: \"Action '\" + action + \"' not supported.\"};\n        }\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/api/v2/alarms/' + alarmId + \"/ticket/\" + action,\n            method: 'POST',\n        });\n    }\n\n    findNodes(options) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n                url: self.url + '/rest/nodes',\n                method: 'GET',\n                params: {\n                    limit: options.limit || self.searchLimit,\n                    match: 'any',\n                    comparator: 'ilike',\n                    orderBy: options.orderBy || 'id',\n                    order: options.order || 'asc',\n                    label: '%' + options.query + '%',\n                    sysName: '%' + options.query + '%',\n                    'ipInterface.ipAddress': '%' + options.query + '%',\n                    'ipInterface.ipHostName': '%' + options.query + '%',\n                    'foreignId': options.query + '%' // doesn't support leading '%'\n                }\n            }).then(function (results) {\n                    return {\n                        'count': results.data.count,\n                        'totalCount': results.data.totalCount,\n                        'rows': results.data.node\n                    };\n                });\n    }\n\n    findUsers(options) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/rest/users',\n            method: 'GET',\n            params: {\n                limit: options.limit || self.searchLimit, // TODO MVR this is not implemented on the user rest service\n            }\n        }).then(function (results) {\n            return {\n                'count': results.data.count,\n                'totalCount': results.data.totalCount,\n                'rows': results.data.user\n            };\n        });\n    }\n\n    findLocations(query) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/api/v2/monitoringLocations',\n            method: 'GET',\n            params: {\n                limit: query.limit || self.searchLimit,\n            }\n        }).then(function (results) {\n            return {\n                'count': results.data.count,\n                'totalCount': results.data.totalCount,\n                'rows': results.data.location\n            };\n        });\n    }\n\n    findCategories(options) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/rest/categories',\n            method: 'GET',\n            params: {\n                limit: options.limit || self.searchLimit, // TODO MVR this is not implemented on the rest service\n            }\n        }).then(function (results) {\n            return {\n                'count': results.data.count,\n                'totalCount': results.data.totalCount,\n                'rows': results.data.category\n            };\n        });\n    }\n\n    findSeverities(options) {\n        var severities = _.map(Model.Severities, function(severity) {\n            return {\n                id: severity.id,\n                label: severity.label\n            };\n        });\n        return this.$q.when(severities);\n    }\n\n    findServices(options) {\n        var self = this;\n        return this.backendSrv.datasourceRequest({\n            url: self.url + '/rest/foreignSourcesConfig/services/default',\n            method: 'GET',\n            params : {\n                limit: options.limit || self.searchLimit\n            }\n        }).then(function (results) {\n            return {\n                'count': results.data.count,\n                'totalCount': results.data.totalCount,\n                'rows': results.data.element\n            };\n        });\n    }\n\n    findOperators() {\n        var operators = _.map(API.Operators, function(operator) {\n            return {\n                id: operator.id,\n                label: operator.label\n            }\n        });\n        return this.$q.when(operators);\n    }\n\n    getAttributes() {\n        let attributes = [\n            { name: \"uei\", type: \"string\" },\n            { name: \"location\", type: \"location\"},\n            { name: \"ipAddress\", type: \"ipaddress\" },\n            { name: \"service\", type: \"service\"},\n            { name: \"severity\", type: \"severity\" },\n            { name: \"alarmAckTime\", type: \"date\"}\n            // TODO MVR add more ...\n        ];\n        return attributes;\n    }\n\n    findAttribute(attributeName) {\n        return _.find(this.getAttributes(), function(attribute) {\n            return attribute.name === attributeName;\n        });\n    }\n\n    // TODO MVR we should get rid of this as well\n    getAttributeComparators(attributeName) {\n        var comparatorMapping = {\n            'uei': ['=', '!='],\n            'location': ['=', '!='],\n            'severity': ['=', '>=', '<=', '>', '<', '!='],\n            'service': ['!=', '='],\n            'ipAddress': ['=', '!='],\n            'alarmAckTime': ['=', '!=']\n        };\n        var comparators = comparatorMapping[attributeName];\n        if (!comparators) {\n            console.log(\"No comparators for attribute with name '\" + attributeName + \"' found.\");\n            return ['='];\n        }\n        return comparators;\n    }\n}\n\n/**\n * The filter may be reloaded from a persisted state.\n * The internal opennms.js API requires a concrete implementation of Comparators or Operators in order to work.\n * As the object was persisted, the references DO NOT MATCH. In order to make them match, we just rebuild the filter.\n */\nexport class FilterInitializer {\n    createFilter(filter) {\n        const newFilter = new API.Filter();\n        newFilter.limit = filter.limit;\n        newFilter.clauses = this.createNestedRestriction(filter).clauses;\n        return newFilter;\n    }\n\n    createClause(clause) {\n        const operator = _.find(API.Operators, function(operator) {\n            return operator.label === clause.operator.label;\n        });\n\n        // Nested restriction\n        if (clause.restriction.clauses) {\n            const nestedRestriction = this.createNestedRestriction(clause.restriction);\n            return new API.Clause(nestedRestriction, operator);\n        } else { // Normal restriction\n            const restriction = this.createRestriction(clause.restriction);\n            return new API.Clause(restriction, operator);\n        }\n    }\n\n    createNestedRestriction(nestedRestriction) {\n        const self = this;\n        const newNestedRestriction = new API.NestedRestriction();\n        _.each(nestedRestriction.clauses, function(clause) {\n            newNestedRestriction.withClause(self.createClause(clause));\n        });\n        return newNestedRestriction;\n    }\n\n    createRestriction(restriction) {\n        const comparator = _.find(API.Comparators, function(comparator) {\n            return comparator.label === restriction.comparator.label;\n        });\n        return new API.Restriction(restriction.attribute, comparator, restriction.value);\n    }\n}"]}